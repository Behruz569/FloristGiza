<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Florist Giza</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #fdf6f6;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    header {
      background-image: url('https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=1350&q=80');
      background-size: cover;
      background-position: center;
      height: 70vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-shadow: 2px 2px 6px rgba(0,0,0,0.5);
      flex-direction: column;
      text-align: center;
      padding: 0 1rem;
    }
    header h1 {
      font-size: 3em;
      margin: 0;
    }
    header p {
      font-size: 1.2em;
      margin-top: 1rem;
      max-width: 600px;
    }
    nav {
      background: #8b0000;
      color: white;
      display: flex;
      justify-content: center;
      gap: 2rem;
      padding: 1rem 0;
      flex-wrap: wrap;
    }
    nav a {
      color: white;
      text-decoration: none;
      font-weight: bold;
      font-size: 1.1rem;
      cursor: pointer;
    }
    section {
      padding: 2rem 1rem;
      max-width: 1000px;
      margin: 0 auto;
      flex-grow: 1;
    }
    h2 {
      color: #8b0000;
      margin-bottom: 1rem;
    }
    .product-card {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 1rem;
      max-width: 280px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-bottom: 1rem;
      background: white;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .product-card img {
      width: 100%;
      border-radius: 10px;
      object-fit: cover;
      height: 180px;
      margin-bottom: 0.8rem;
    }
    footer {
      text-align: center;
      padding: 1.5rem;
      background-color: #222;
      color: #eee;
      margin-top: auto;
    }
    input, button, textarea {
      padding: 10px;
      margin: 5px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box;
      font-size: 1rem;
      font-family: inherit;
    }
    textarea {
      resize: vertical;
      min-height: 70px;
    }
    button {
      background: #8b0000;
      color: white;
      cursor: pointer;
      border: none;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #a10000;
    }
    #product-list {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    form {
      max-width: 350px;
      margin-bottom: 2rem;
      background: white;
      padding: 1rem 1.5rem 1.5rem 1.5rem;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    #online-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: bold;
      color: #2d862d;
      margin-left: auto;
      font-size: 1rem;
    }
    #online-dot {
      width: 14px;
      height: 14px;
      background-color: #2d862d;
      border-radius: 50%;
    }
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>

<header>
  <h1>Florist Giza</h1>
  <p>–ö—Ä–∞—Å–æ—Ç–∞, —Ç—Ä—É–¥ –∏ –ª—é–±–æ–≤—å –≤ –∫–∞–∂–¥–æ–º —Ü–≤–µ—Ç–∫–µ üå∏. –†–∞–±–æ—Ç–∞–µ–º —Å –¥—É—à–æ–π —Ä–∞–¥–∏ –≤–∞—à–µ–≥–æ —Å—á–∞—Å—Ç—å—è.</p>
</header>

<nav>
  <a href="#catalog">–ö–∞—Ç–∞–ª–æ–≥</a>
  <a href="#add-product" id="nav-add-product" class="hidden">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
  <a href="#register" id="nav-register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
  <a href="#login" id="nav-login">–í—Ö–æ–¥</a>
  <a href="#" id="nav-logout" class="hidden">–í—ã–π—Ç–∏</a>
  <div id="online-status"><div id="online-dot"></div><span id="online-count">0</span> –æ–Ω–ª–∞–π–Ω</div>
</nav>

<section id="catalog">
  <h2>–ö–∞—Ç–∞–ª–æ–≥</h2>
  <div id="product-list"></div>
</section>

<section id="register">
  <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
  <form id="registerForm">
    <input type="text" id="reg-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω (+998...)" pattern="^\+998\d{9}$" title="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤ —Ñ–æ—Ä–º–∞—Ç–µ +998xxxxxxxxx" required />
    <input type="password" id="reg-password" placeholder="–ü–∞—Ä–æ–ª—å" minlength="4" required />
    <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
  </form>
</section>

<section id="login">
  <h2>–í—Ö–æ–¥</h2>
  <form id="loginForm">
    <input type="text" id="login-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω (+998...)" pattern="^\+998\d{9}$" title="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤ —Ñ–æ—Ä–º–∞—Ç–µ +998xxxxxxxxx" required />
    <input type="password" id="login-password" placeholder="–ü–∞—Ä–æ–ª—å" minlength="4" required />
    <button type="submit">–í–æ–π—Ç–∏</button>
  </form>
</section>

<section id="add-product" class="hidden">
  <h2>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)</h2>
  <form id="addProductForm">
    <input type="text" id="product-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" required />
    <textarea id="product-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" required></textarea>
    <input type="file" id="product-image" accept="image/*" required />
    <button type="submit">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
  </form>
</section>

<footer>
  ¬© 2025 Florist Giza | –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é ‚ù§Ô∏è
</footer>

<script>
  // Telegram bot info (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ)
  const telegramBotToken = "5641966809:AAEJVSxOLel8gcRQOVg_AcJOR8W0G1nC9Po";
  const telegramChatId = "5585811533";

  const admins = ["+998940233830", "+998909059078"];
  const adminPin = "1397";

  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
  const navAddProduct = document.getElementById("nav-add-product");
  const navRegister = document.getElementById("nav-register");
  const navLogin = document.getElementById("nav-login");
  const navLogout = document.getElementById("nav-logout");
  const onlineCountEl = document.getElementById("online-count");

  // –°–µ–∫—Ü–∏–∏
  const addProductSection = document.getElementById("add-product");
  const registerSection = document.getElementById("register");
  const loginSection = document.getElementById("login");

  // –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ localStorage
  function getLoggedUser() {
    return JSON.parse(localStorage.getItem("loggedUser") || "null");
  }

  function setLoggedUser(user) {
    localStorage.setItem("loggedUser", JSON.stringify(user));
  }

  function logoutUser() {
    localStorage.removeItem("loggedUser");
    alert("–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞");
    updateUI();
  }

  // –û–±–Ω–æ–≤–ª—è–µ–º UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  function updateUI() {
    const user = getLoggedUser();
    if (user) {
      navAddProduct.classList.toggle("hidden", !user.isAdmin);
      navRegister.classList.add("hidden");
      navLogin.classList.add("hidden");
      navLogout.classList.remove("hidden");
      registerSection.classList.add("hidden");
      loginSection.classList.add("hidden");
      if (user.isAdmin) {
        addProductSection.classList.remove("hidden");
      } else {
        addProductSection.classList.add("hidden");
      }
    } else {
      navAddProduct.classList.add("hidden");
      navRegister.classList.remove("hidden");
      navLogin.classList.remove("hidden");
      navLogout.classList.add("hidden");
      addProductSection.classList.add("hidden");
      registerSection.classList.remove("hidden");
      loginSection.classList.remove("hidden");
    }
  }

  // –†–µ–Ω–¥–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ —Ç–æ–≤–∞—Ä–æ–≤
  function renderProducts() {
    const container = document.getElementById("product-list");
    container.innerHTML = "";
    const products = JSON.parse(localStorage.getItem("products") || "[]");
    if (products.length === 0) {
      container.innerHTML = "<p>–¢–æ–≤–∞—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.</p>";
      return;
    }
    products.forEach(prod => {
      const card = document.createElement("div");
      card.className = "product-card";
      card.innerHTML = `
        <img src="${prod.imageUrl}" alt="${prod.name}" />
        <h3>${prod.name}</h3>
        <p>${prod.description}</p>
        <button onclick="orderProduct('${prod.id}')">üõí –ó–∞–∫–∞–∑–∞—Ç—å (${prod.id})</button>
      `;
      container.appendChild(card);
    });
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
  document.getElementById("addProductForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const user = getLoggedUser();
    if (!user || !user.isAdmin) {
      alert("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞: –≤—ã –Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä");
      return;
    }

    const name = document.getElementById("product-name").value.trim();
    const description = document.getElementById("product-description").value.trim();
    const imageInput = document.getElementById("product-image");
    const file = imageInput.files[0];

    if (!name || !description || !file) {
      alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ");
      return;
    }

    const reader = new FileReader();
    reader.onload = function (e) {
      const imageUrl = e.target.result;
      const productId = generateId();

      const products = JSON.parse(localStorage.getItem("products") || "[]");
      products.push({ id: productId, name, description, imageUrl });
      localStorage.setItem("products", JSON.stringify(products));

      renderProducts();
      alert("–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω!");

      // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
      e.target.reset();

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram
      const message = `üõçÔ∏è –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω!\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${name}\n–û–ø–∏—Å–∞–Ω–∏–µ: ${description}\nID: ${productId}\n–î–æ–±–∞–≤–∏–ª: ${user.phone}`;
      fetch(`https://api.telegram.org/bot${telegramBotToken}/sendMessage?chat_id=${telegramChatId}&text=${encodeURIComponent(message)}`);
    };
    reader.readAsDataURL(file);
  });

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  document.getElementById("registerForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const ph = document.getElementById("reg-phone").value.trim();
    const pw = document.getElementById("reg-password").value;
    if (!ph || !pw) { alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è"); return; }

    let users = JSON.parse(localStorage.getItem("users") || "[]");
    if (users.find(u => u.phone === ph)) {
      alert("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç");
      return;
    }
    users.push({ phone: ph, password: pw });
    localStorage.setItem("users", JSON.stringify(users));
    alert("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ");
    this.reset();
  });

  // –í—Ö–æ–¥
  document.getElementById("loginForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const ph = document.getElementById("login-phone").value.trim();
    const pw = document.getElementById("login-password").value;

    const users = JSON.parse(localStorage.getItem("users") || "[]");
    const user = users.find(u => u.phone === ph && u.password === pw);
    if (!user) {
      alert("–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
      return;
    }

    let isAdmin = admins.includes(ph);
    if (isAdmin) {
      const pin = prompt("–í–≤–µ–¥–∏—Ç–µ PIN –¥–ª—è –∞–¥–º–∏–Ω–∞:");
      if (pin !== adminPin) {
        alert("–ù–µ–≤–µ—Ä–Ω—ã–π PIN");
        return;
      }
    }

    setLoggedUser({ phone: ph, isAdmin });
    alert("–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏!");
    this.reset();
    updateUI();
  });

  // –í—ã—Ö–æ–¥
  navLogout.addEventListener("click", function(e) {
    e.preventDefault();
    logoutUser();
  });

  // –ó–∞–∫–∞–∑–∞—Ç—å —Ç–æ–≤–∞—Ä (–æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ —Ç–µ–ª–µ–≥—É)
  function orderProduct(productId) {
    const user = getLoggedUser();
    if (!user) {
      alert("–î–ª—è –∑–∞–∫–∞–∑–∞ –Ω—É–∂–Ω–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É");
      return;
    }
    const message = `üõçÔ∏è –ù–æ–≤—ã–π –∑–∞–∫–∞–∑!\nID —Ç–æ–≤–∞—Ä–∞: ${productId}\n–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–∫—É–ø–∞—Ç–µ–ª—è: ${user.phone}`;
    fetch(`https://api.telegram.org/bot${telegramBotToken}/sendMessage?chat_id=${telegramChatId}&text=${encodeURIComponent(message)}`);
    alert("–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –¥–ª—è —Ç–æ–≤–∞—Ä–∞
  function generateId() {
    return 'ID' + Math.floor(Math.random() * 1000000) + Date.now();
  }

  // –°—á—ë—Ç—á–∏–∫ –æ–Ω–ª–∞–π–Ω (—É—Å–ª–æ–≤–Ω—ã–π, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 1 –µ—Å–ª–∏ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω)
  function updateOnlineStatus() {
    const user = getLoggedUser();
    onlineCountEl.textContent = user ? "1" : "0";
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  function init() {
    updateUI();
    renderProducts();
    updateOnlineStatus();
  }

  document.addEventListener("DOMContentLoaded", init);
</script>

</body>
</html>
